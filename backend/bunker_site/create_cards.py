# -*- coding: utf-8 -*-
import os
import sys
import django

# Настройка Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'bunker_site.settings')
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
django.setup()

from django.contrib.auth.models import User
from bunker_game.models import Deck, Card

def create_cards():
    print("=" * 50)
    print("НАЧИНАЕМ СОЗДАНИЕ КАРТОЧЕК")
    print("=" * 50)
    
    # 1. Создаем или получаем пользователя
    try:
        user = User.objects.get(username='admin')
        print(f"✓ Найден пользователь: {user.username}")
    except User.DoesNotExist:
        user = User.objects.create_user(
            username='admin',
            email='admin@example.com',
            password='admin123'
        )
        print(f"✓ Создан пользователь: {user.username} (пароль: admin123)")
    
    # 2. Создаем колоду
    deck, created = Deck.objects.get_or_create(
        name='Основная колода',
        defaults={'user': user}
    )
    if created:
        print(f"✓ Создана колода: {deck.name}")
    else:
        print(f"✓ Используем существующую колоду: {deck.name}")
    
    # 3. Удаляем старые карточки (если есть)
    old_count = deck.cards.count()
    if old_count > 0:
        deck.cards.all().delete()
        print(f"✓ Удалено старых карточек: {old_count}")
    
    # 4. Создаем карточки КАТАСТРОФЫ (10 штук)
    print("\n" + "=" * 30)
    print("СОЗДАНИЕ КАТАСТРОФ (10 штук)")
    print("=" * 30)
    
    catastrophe_cards = [
        ("Ядерная война", "Глобальный ядерный конфликт уничтожил цивилизацию. Выжившие сталкиваются с радиацией и ядерной зимой."),
        ("Пандемия Z-Virus", "Смертельный вирус с 95% летальностью. Мир в карантине, правительства пали."),
        ("Падение астероида", "Гигантский астероид упал в океан, вызвав цунами и вулканическую зиму."),
        ("Восстание машин", "ИИ захватил контроль над всеми системами. Человечество борется за выживание."),
        ("Солнечная вспышка", "Мощная солнечная буря уничтожила всю электронику на планете."),
        ("Зомби-апокалипсис", "Неизвестный вирус превращает людей в агрессивных зомби."),
        ("Глобальное потепление", "Ледники растаяли, города затоплены, климат необратимо изменился."),
        ("Инопланетное вторжение", "Внеземная цивилизация начала терраформирование Земли."),
        ("Вулканическая зима", "Извержение супервулкана покрыло планету пеплом на годы."),
        ("Нанороботы", "Самовоспроизводящиеся нанороботы поглощают всю органику на поверхности.")
    ]
    
    for title, description in catastrophe_cards:
        Card.objects.create(
            deck=deck,
            card_type='catastrophe',
            title=title,
            description=description
        )
        print(f"✓ {title}")
    
    # 5. Создаем карточки БУНКЕРЫ (10 штук)
    print("\n" + "=" * 30)
    print("СОЗДАНИЕ БУНКЕРОВ (10 штук)")
    print("=" * 30)
    
    bunker_cards = [
        ("Секретный военный бункер", "Заброшенный бункер времен холодной войны. Запас еды на 5 лет, система фильтрации воздуха."),
        ("Подземная лаборатория", "Научная лаборатория на глубине 200м. Есть теплицы и генераторы."),
        ("Шахта", "Заброшенная угольная шахта. Много туннелей, естественная защита от радиации."),
        ("Метро", "Станция метро глубокого заложения. Много помещений, но ограниченные ресурсы."),
        ("Горная пещера", "Естественная пещера, оборудованная для выживания. Защищена от внешних угроз."),
        ("Подводная база", "База на морском дне. Полная автономность, но нет связи с поверхностью."),
        ("Заводской бункер", "Подземные цеха заброшенного завода. Много оборудования и материалов."),
        ("Биосфера", "Экспериментальная закрытая экосистема. Собственное производство кислорода и пищи."),
        ("Арктическая станция", "Научная станция в вечной мерзлоте. Хорошо изолирована от внешнего мира."),
        ("Хранилище семян", "Глобальное хранилище на Шпицбергене. Отличная защита, много семян.")
    ]
    
    for title, description in bunker_cards:
        Card.objects.create(
            deck=deck,
            card_type='bunker',
            title=title,
            description=description
        )
        print(f"✓ {title}")
    
    # 6. Создаем карточки ПРОФЕССИИ (10 штук)
    print("\n" + "=" * 30)
    print("СОЗДАНИЕ ПРОФЕССИЙ (10 штук)")
    print("=" * 30)
    
    profession_cards = [
        ("Врач", "Терапевт с 10-летним опытом. Может лечить большинство болезней."),
        ("Инженер", "Специалист по системам жизнеобеспечения. Может чинить оборудование."),
        ("Ученый-биолог", "Знает биологию, генетику. Может создавать лекарства."),
        ("Психолог", "Помогает справляться со стрессом и конфликтами."),
        ("Повар", "Умеет готовить из ограниченных ресурсов вкусную еду."),
        ("Электрик", "Разбирается в электросистемах и генераторах."),
        ("Строитель", "Может строить и ремонтировать сооружения."),
        ("Фермер", "Знает сельское хозяйство, может выращивать еду."),
        ("Военный", "Тактические навыки, дисциплина, опыт выживания."),
        ("Программист", "Может восстанавливать и программировать компьютеры.")
    ]
    
    for title, description in profession_cards:
        Card.objects.create(
            deck=deck,
            card_type='profession',
            title=title,
            description=description
        )
        print(f"✓ {title}")
    
    # 7. Создаем карточки ЗДОРОВЬЕ (10 штук)
    print("\n" + "=" * 30)
    print("СОЗДАНИЕ ЗДОРОВЬЯ (10 штук)")
    print("=" * 30)
    
    health_cards = [
        ("Идеальное здоровье", "Нет хронических заболеваний, отличная физическая форма."),
        ("Диабет", "Требует регулярных инъекций инсулина."),
        ("Астма", "Проблемы с дыханием в пыльных помещениях."),
        ("Аллергия на антибиотики", "Ограниченный выбор лекарств."),
        ("Глухота", "Плохо слышит, могут быть проблемы с коммуникацией."),
        ("Близорукость", "Плохо видит без очков."),
        ("Гипертония", "Высокое давление, требует постоянного контроля."),
        ("Аллергия на пыль", "Чихает в пыльных помещениях."),
        ("Перелом ноги", "Ходит с костылями, медленно передвигается."),
        ("Мигрень", "Частые сильные головные боли.")
    ]
    
    for title, description in health_cards:
        Card.objects.create(
            deck=deck,
            card_type='health',
            title=title,
            description=description
        )
        print(f"✓ {title}")
    
    # 8. Создаем карточки ХОББИ (10 штук)
    print("\n" + "=" * 30)
    print("СОЗДАНИЕ ХОББИ (10 штук)")
    print("=" * 30)
    
    hobby_cards = [
        ("Чтение", "Большая коллекция книг, может учить других."),
        ("Музыка", "Играет на гитаре, поднимает настроение."),
        ("Шахматы", "Тактическое мышление, может обучать стратегии."),
        ("Садоводство", "Опыт выращивания растений в ограниченных условиях."),
        ("Кулинария", "Умеет готовить вкусно из простых ингредиентов."),
        ("Рукоделие", "Может шить и чинить одежду."),
        ("Рыбалка", "Знает где и как ловить рыбу."),
        ("Астрономия", "Знает звезды, может ориентироваться по ним."),
        ("Рисование", "Художник, может создавать карты и схемы."),
        ("Спорт", "Тренирует других, поддерживает физическую форму.")
    ]
    
    for title, description in hobby_cards:
        Card.objects.create(
            deck=deck,
            card_type='hobby',
            title=title,
            description=description
        )
        print(f"✓ {title}")
    
    # 9. Создаем карточки ХАРАКТЕР (10 штук)
    print("\n" + "=" * 30)
    print("СОЗДАНИЕ ХАРАКТЕРА (10 штук)")
    print("=" * 30)
    
    personality_cards = [
        ("Лидер", "Умеет вести за собой, принимать решения."),
        ("Оптимист", "Всегда видит хорошее, поднимает настроение."),
        ("Пессимист", "Всегда ожидает худшего, демотивирует других."),
        ("Трудоголик", "Работает больше всех, но может переутомиться."),
        ("Лентяй", "Избегает работы, ищет легкие пути."),
        ("Агрессивный", "Легко выходит из себя, создает конфликты."),
        ("Дипломат", "Умеет договариваться, разрешает споры."),
        ("Паникер", "Впадает в панику при малейшей опасности."),
        ("Хладнокровный", "Сохраняет спокойствие в любой ситуации."),
        ("Эгоист", "Думает только о себе, не делится ресурсами.")
    ]
    
    for title, description in personality_cards:
        Card.objects.create(
            deck=deck,
            card_type='personality',
            title=title,
            description=description
        )
        print(f"✓ {title}")
    
    # 10. Создаем карточки БАГАЖ (10 штук)
    print("\n" + "=" * 30)
    print("СОЗДАНИЕ БАГАЖА (10 штук)")
    print("=" * 30)
    
    luggage_cards = [
        ("Аптечка", "Полный набор лекарств и перевязочных материалов."),
        ("Еда", "Запас консервов и сухпайков на 6 месяцев."),
        ("Оружие", "Пистолет с 50 патронами для защиты."),
        ("Инструменты", "Набор для ремонта оборудования и сооружений."),
        ("Книги", "Энциклопедия выживания и учебники."),
        ("Семена", "Набор семян овощей для выращивания."),
        ("Радио", "Радиостанция для связи с внешним миром."),
        ("Генератор", "Бензиновый генератор для электроснабжения."),
        ("Вода", "Запас питьевой воды и фильтры."),
        ("Одежда", "Теплая одежда и спальные мешки.")
    ]
    
    for title, description in luggage_cards:
        Card.objects.create(
            deck=deck,
            card_type='luggage',
            title=title,
            description=description
        )
        print(f"✓ {title}")
    
    # 11. Создаем карточки ДОПОЛНИТЕЛЬНЫЙ ФАКТ (10 штук)
    print("\n" + "=" * 30)
    print("СОЗДАНИЕ ДОПОЛНИТЕЛЬНЫХ ФАКТОВ (10 штук)")
    print("=" * 30)
    
    additional_cards = [
        ("Бывший спортсмен", "Отличная физическая форма, выносливость."),
        ("Полиглот", "Знает 5 языков, может общаться с разными людьми."),
        ("Клаустрофобия", "Боится закрытых пространств, паникует в бункере."),
        ("Вегетарианец", "Не ест мясо, нуждается в растительной пище."),
        ("Беременность", "Беременна 4 месяца, скоро роды."),
        ("Бывший наркоман", "В ремиссии 2 года, но может сорваться."),
        ("Криминал", "Судимость за кражу, может воровать."),
        ("Богатство", "Знает где спрятаны ресурсы, имеет связи."),
        ("Экстрасенс", "Утверждает, что видит будущее."),
        ("Аллергия на животных", "Но в бункере есть собака.")
    ]
    
    for title, description in additional_cards:
        Card.objects.create(
            deck=deck,
            card_type='additional',
            title=title,
            description=description
        )
        print(f"✓ {title}")
    
    # 12. Итоги
    total_cards = deck.cards.count()
    print("\n" + "=" * 50)
    print("СОЗДАНИЕ ЗАВЕРШЕНО!")
    print("=" * 50)
    print(f"Всего создано карточек: {total_cards}")
    print(f"Колода: {deck.name}")
    print(f"Создатель: {user.username}")
    
    # Показываем статистику по типам
    print("\nСтатистика по типам карточек:")
    for card_type, display_name in Card.CARD_TYPES:
        count = deck.cards.filter(card_type=card_type).count()
        print(f"  {display_name}: {count} карточек")
    
    print("\nГотово! База данных заполнена.")

if __name__ == '__main__':
    create_cards()